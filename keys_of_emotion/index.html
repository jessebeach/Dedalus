<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DedalusWeb Story</title>

    <script src="../src/html/plugins/doT.min.js"></script>
    <script src="../src/html/plugins/jquery.min.js"></script>
    <script src="../src/dedalus.js"></script>
    <script src="../src/dedalus-web.js"></script>

    <link rel="stylesheet" href="../src/html/themes/plain/story.css">

 </head>
<body>
    <div id="story">

        <initscript>
        </initscript>

        <beforeEveryThing>
        </beforeEveryThing>

        <beforeEveryPageTurn>
        </beforeEveryPageTurn>

        <beforeEveryParagraphShown>
        </beforeEveryParagraphShown>

        <afterEveryThing>
        </afterEveryThing>

        <afterEveryPageTurn>
        </afterEveryPageTurn>

        <afterEveryParagraphShown>
        </afterEveryParagraphShown>

        <!-- Novel -->
        <title>The Five Keys of Emotion</title>

        <!-- Objects -->
        <obj id="key_happy" inventoryName="Key of Happiness">
          <action id="Examine">
            The key is heavy and made of steel.
          </action>
          <action id="Take">
            <when>!story.isInInventory('key_happy')</when>
            Wow, it's heavier than you thought!
            {{ story.putInInventory('key_happy'); }}
            You place the key in your jacket pocket.
          </action>
          <action id="Decline">
            <when>!story.isInInventory('key_happy')</when>
            {{ story.turnTo('ended_before_it_even_starts'); }}
          </action>
          <action id="Drop">
            You start to place the key on the ground, but something stops you. You find that you can't part with it.
          </action>
        </obj>

        <!-- Characters -->
        <character id="starmarsh_meet">
          <action id="Greet">
            <p>Well met, fellow traveler.</p>
          </action>
          <action id="Who are you?">
            <p>I am a traveler, like you.</p>
          </action>
          <action id="What do you want?">
            <p>I would like to return this <interact with="key_happy">key</interact> to you. It is yours.</p>
          </action>
        </character>

        <!-- Pages -->
        <page id="intro">
          <p>In a time long before ours, a creature of whimsy decided to hide something precious. It never spoke of what it was, but only of what it was worth. And to hear the creature speak of it, it was worth much.</p>
        </page>

        <page id="start" class="first">
          <p>This is the story your mother told you as a child. She named the creature <i>Starmarsh</i> and used this story to distract you in moments of tantrum. You know this now, a parent yourself, and keenly aware of the whims of children. But Starmarsh faded from your memory as you aged...until today, as you were walking the shortcut through the woods.</p>
          <p>On the trail ahead, you see a small person approach. The person walks right to you, <interact with="starmarsh_meet">blocking your path</interact>.</p>
        </page>

        <page id="ended_before_it_even_starts">
          <p>Thank you, but I think you have mistaken me for someone else.</p>
          <p>You continue down the path, wondering for a moment who that strange person was. By the time you get to the market, you've already forgotten him.</p>
          {{ story.endGame(); }}
        </page>

    </div>

    <div id="wrapper">
      <div id="main" role="main">
        <h1 id="title"></h1>
        <div id="host" role="log" aria-live="assertive"></div>
      </div>
      <div id="inventoryHostWrapper" role="complementary">
        <h2>Inventory</h2>
        <div id="inventoryHost"></div>
      </div>
    </div>

    <div id="footer" role="navigation">
      <h2>Controls</h2>
      <ul>
        <li><a id="undoHost" href="#">Undo</a></li>
        <li><a id="saveHost" href="#">Save</a></li>
        <li><a id="restoreHost" href="#">Restore</a></li>
        <li><a id="reseteHost" href="#">Reset</a></li>
      </ul>
    </div>

    <div id="interactionHost" tabindex="-1"></div>

    <div id="undoStageHost" tabindex="-1"></div>

    <script>
        $(function () {
            new DedalusWeb({
                domSource         : $('#story'),
                domTarget         : $('#host'),
                titleTarget       : $('#title'),
                inventoryTarget   : $('#inventoryHost'),
                interactionTarget : $('#interactionHost'),
                undoTarget        : $('#undoHost'),
                undoStageTarget   : $('#undoStageHost'),
                saveTarget        : $('#saveHost'),
                restoreTarget     : $('#restoreHost'),
                resetTarget       : $('#reseteHost'),
            });
        });

    </script>
</body>
</html>
